messages:
  step: "Paso"
  start: "INICIO"
  end: "FIN"
  continue: "Presione Enter para continuar o Ctrl+C para Cancelar"
  step1:
    title: ğŸ“‚ Comencemos con los Contenedores
    prompt: |
      Ejecutemos un contenedor y verifiquemos que nuestra instalaciÃ³n funciona.
      Acceda a una terminal y ejecute el comando:

      podman run --rm hello-world

  step2:
    title: "ğŸš€ Ejecutemos un contenedor con una pÃ¡gina HTML"
    prompt: |
      Veamos cÃ³mo un contenedor expone un puerto de comunicaciÃ³n para recibir acceso externo.
      Ejecute un contenedor que exponga una pÃ¡gina HTML.

      Acceda a una terminal y ejecute el comando:

      podman run --rm --name hello -p 8180:80 docker/welcome-to-docker

      Acceda a la direcciÃ³n a travÃ©s de un navegador: ğŸŒ http://localhost:8180

  step3:
    title: "ğŸ’» Listar contenedores en ejecuciÃ³n"
    prompt: |
      Acceda a una nueva terminal y liste los contenedores en ejecuciÃ³n con el comando:

      podman ps

  step4:
    title: "ğŸš‘ Detener un contenedor"
    prompt: |
      Ahora detengamos el contenedor que estÃ¡ en ejecuciÃ³n.
      Acceda a una terminal y ejecute el comando:

      podman stop hello

      O vaya a la terminal donde el contenedor estÃ¡ en ejecuciÃ³n y presione Ctrl+C.

  step5:
    title: ğŸ“‚ Comencemos con el Containerfile
    prompt: |
      Ahora comenzaremos con el Containerfile.
      Por favor, abra la carpeta {{ playbook_dir }}/container-fundamentals/basic.
      Examine el Containerfile.

  step6:
    title: ğŸ— Construir la imagen del contenedor
    prompt: |
      Vamos a crear una imagen con el contenido de esta carpeta.
      Acceda a una terminal y ejecute el comando:

      cd {{ playbook_dir }}/container-fundamentals/basic
      podman build -t container-journey/basic .

  step7:
    title: ğŸ’» Mostrar la imagen generada
    prompt: |
      Liste las imÃ¡genes con el comando:

      podman images --filter 'reference=container-journey/basic'

  step8:
    title: ğŸš€ Ejecutar el contenedor con la imagen generada
    prompt: |
      Ahora ejecutemos el contenedor con la imagen que acabamos de crear.
      Acceda a una terminal y ejecute el comando:

      podman run --rm --name basic -p 8180:80 container-journey/basic

      Acceda a la direcciÃ³n a travÃ©s de un navegador: ğŸŒ http://localhost:8180

      No olvide detener el contenedor despuÃ©s de la prueba.

  step9:
    title: ğŸ—„ï¸ Trabajando con volÃºmenes
    prompt: |
      El namespace MNT que administra el sistema de archivos es efÃ­mero por defecto.
      Si no utiliza volÃºmenes, todo lo que haga en el contenedor se perderÃ¡ cuando lo destruya.
      Para manejar sistemas de archivos persistentes, necesitamos usar volÃºmenes.
      
      Navegue a la carpeta {{ playbook_dir }}/container-fundamentals/volumes
      
      Examine el contenido de la carpeta.

  step10:
    title: ğŸš€ Ejecutar un contenedor con volumen
    prompt: |
      Ejecutemos un contenedor que acceda a los archivos en la carpeta html.
      Acceda a una terminal y ejecute los siguientes comandos:

      cd {{ playbook_dir }}/container-fundamentals/volumes
      podman run --rm --name volumes -p 8180:80 -v $(pwd)/html:/usr/share/nginx/html:ro nginx:alpine

      Acceda a la direcciÃ³n a travÃ©s de un navegador: ğŸŒ http://localhost:8180

  step11:
    title: ğŸ“ Modificar archivos y reflejar los cambios en el contenedor
    prompt: |
      Edite el archivo {{ playbook_dir }}/container-fundamentals/volumes/html/index.html.
      Luego, actualice la pÃ¡gina en el navegador ğŸŒ http://localhost:8180 para ver los cambios.

      No olvide detener el contenedor despuÃ©s de la prueba.

  step12:
    title: "ğŸ“¦ Containerizando la soluciÃ³n de demostraciÃ³n"
    prompt: |
      Ahora que tenemos una comprensiÃ³n bÃ¡sica de los contenedores, 
      Comencemos el proceso para ejecutar nuestra aplicaciÃ³n en contenedores.

      Comenzaremos empaquetando el backend, una aplicaciÃ³n Java con Quarkus.

      El backend se conecta a una base de datos Postgres
      AsÃ­ que lo primero que necesitamos hacer es tener una instancia de Postgres en ejecuciÃ³n en nuestra mÃ¡quina.

  step13:
    title: "ğŸ”— ComunicaciÃ³n entre contenedores"
    prompt: |
      Antes de ejecutar nuestro contenedor de base de datos, es importante comprender cÃ³mo funciona la comunicaciÃ³n entre contenedores.

      Cuando ejecutamos contenedores, por defecto, operan en sus propias redes aisladas por seguridad.

      Para que dos contenedores se comuniquen entre sÃ­, necesitamos crear una red compartida.

      Sin este puente explÃ­cito, los contenedores no pueden "verse" entre sÃ­, incluso cuando estÃ¡n en el mismo host fÃ­sico.

      +------------+         +------------+
      | Contenedor |  <--->  | Contenedor |
      |      A     |         |      B     |
      +------------+         +------------+
             |                     |
             |   +-------------+   |
             +---|   Red       |---+
                 +-------------+

  step14:
    title: "ğŸ”— Creando una red para los contenedores"
    prompt: |
      Creemos una red para que los contenedores se comuniquen entre sÃ­.
      Acceda a una terminal y ejecute el comando:

      podman network create container-journey

      Este comando crea una red llamada container-journey.

  step15:
    title: "ğŸš€ Ejecutando el contenedor de Postgres en modo desatendido usando la red container-journey"
    prompt: |
      Ejecuta el contenedor de Postgres en modo desatendido para que se ejecute en segundo plano.
      Accede a un terminal y ejecuta los comandos:

      cd {{ playbook_dir }}/banking-backend
      
      mkdir -p volumes/data
      
      podman run -d --rm --name postgres \
      -e POSTGRES_PASSWORD=postgres \
      -e POSTGRES_DB=banking \
      -e POSTGRES_USER=postgres \
      --network container-journey \
      -v $(pwd)/volumes/data:/var/lib/postgresql/data \
      postgres:17-alpine

  step16:
    title: "ğŸ” Examinando el Containerfile del backend"
    prompt: |
      Navega a la carpeta {{ playbook_dir }}/banking-backend/src/main/container.
      Examina el contenido del archivo Containerfile:

      cat {{ playbook_dir }}/banking-backend/src/main/container/Containerfile

  step17:
    title: "ğŸ— ConstrucciÃ³n de la imagen del contenedor del backend"
    prompt: |
      Creemos una imagen para la aplicaciÃ³n backend.
      Accede a un terminal y ejecuta el comando:

      cd {{ playbook_dir }}/banking-backend
      podman build -f src/main/container/Containerfile -t quay.io/masales/banking-backend:1.0.0 .

      ** El nombre de la imagen estÃ¡ alineado con el repositorio remoto **

  step18:
    title: "ğŸ’» Mostrar la imagen generada"
    prompt: |
      Lista las imÃ¡genes con el comando:

      podman images --filter 'reference=quay.io/masales/banking-backend:1.0.0'

  step19:
    title: "ğŸš€ Ejecutar el contenedor del backend con la imagen generada"
    prompt: |
      Ahora ejecutemos el contenedor del backend con la imagen que acabamos de crear.
      Accede a un terminal y ejecuta el comando:

      podman run -d --rm --name backend \
      --network container-journey \
      -e POSTGRES_HOST=postgres \
      -p 8080:8080 quay.io/masales/banking-backend:1.0.0

  step20:
    title: "ğŸŒ Acceder a la aplicaciÃ³n backend"
    prompt: |
      Accede a un terminal y ejecuta los siguientes comandos para validar la API expuesta por el contenedor:

      [Listar todas las cuentas]
      curl -X GET http://localhost:8080/api/accounts -H "Accept: application/json"

      [Crear una nueva cuenta]
      curl -X POST http://localhost:8080/api/accounts \
      -H "Content-Type: application/json" \
      -d '{
        "accountNumber": "ACC123456",
        "ownerName": "John Doyle",
        "balance": 1000.00
      }'

      [Obtener cuenta por nÃºmero]
      curl -X GET http://localhost:8080/api/accounts/number/ACC123456 -H "Accept: application/json"

      [Realizar un depÃ³sito]
      curl -X POST "http://localhost:8080/api/accounts/ACC123456/deposit?amount=500.00" \
      -H "Content-Type: application/json"

      [Realizar un retiro]
      curl -X POST "http://localhost:8080/api/accounts/ACC123456/withdraw?amount=200.00" \
      -H "Content-Type: application/json"

  step21:
    title: "ğŸ” Examinando el Containerfile del frontend"
    prompt: |
      Navega a la carpeta {{ playbook_dir }}/banking-frontend.
      Examina el contenido del archivo Containerfile:

      cat {{ playbook_dir }}/banking-frontend/Containerfile

  step22:
    title: "ğŸ— ConstrucciÃ³n de la imagen del contenedor del frontend"
    prompt: |
      Creemos una imagen para la aplicaciÃ³n frontend.
      Accede a un terminal y ejecuta el comando:

      cd {{ playbook_dir }}/banking-frontend
      podman build -t quay.io/masales/banking-frontend:1.0.0 .

      ** El nombre de la imagen estÃ¡ alineado con el repositorio remoto **

  step23:
    title: "ğŸ’» Mostrar la imagen generada"
    prompt: |
      Lista las imÃ¡genes con el comando:

      podman images --filter 'reference=quay.io/masales/banking-frontend:1.0.0'

  step24:
    title: "ğŸš€ Ejecutar el contenedor del frontend con la imagen generada"
    prompt: |
      Ahora ejecutemos el contenedor del frontend con la imagen que acabamos de crear.
      Accede a un terminal y ejecuta el comando:

      podman run -d --rm --name frontend \
      -e API_URL="http://localhost:8080/api/accounts" \
      -p 8180:80 \
      quay.io/masales/banking-frontend:1.0.0

  step25:
    title: "ğŸŒ Acceder a la aplicaciÃ³n frontend"
    prompt: |
      Accede a la direcciÃ³n a travÃ©s de un navegador: ğŸŒ http://localhost:8180

  step26:
    title: "ğŸ’» Listar contenedores en ejecuciÃ³n"
    prompt: |
      Accede a un terminal y lista los contenedores en ejecuciÃ³n con el comando:

      podman ps

  step27:
    title: "â¬†ï¸ PublicaciÃ³n de imÃ¡genes en el repositorio remoto"
    prompt: |
      Publiquemos las imÃ¡genes generadas localmente en un repositorio remoto.

      Abre un terminal y escribe los siguientes comandos:

      podman login quay.io
      podman push quay.io/masales/banking-backend:1.0.0
      podman push quay.io/masales/banking-frontend:1.0.0

  step28:
    title: "ğŸš€ Ejecutando las imÃ¡genes en otro host"
    prompt: |
      Ahora que hemos publicado las imÃ¡genes en el repositorio remoto, ejecutÃ©moslas en otro host.

      Accede a un terminal y ejecuta los siguientes comandos:

      podman network create container-journey

      mkdir -p /tmp/volumes/data

      podman run -d --rm --name postgres \
      -e POSTGRES_PASSWORD=postgres \
      -e POSTGRES_DB=banking \
      -e POSTGRES_USER=postgres \
      --network container-journey \
      -v /tmp/volumes/data:/var/lib/postgresql/data:Z \
      postgres:17-alpine

      podman run -d --rm --name backend \
      --network container-journey \
      -e POSTGRES_HOST=postgres \
      -p 8180:8080 quay.io/masales/banking-backend:1.0.0

      podman run -d --rm --name frontend \
      -e API_URL="http://fedora-linux:8180/api/accounts" \
      -p 8080:80 \
      quay.io/masales/banking-frontend:1.0.0

      Accede a la direcciÃ³n a travÃ©s de un navegador: ğŸŒ http://fedora-linux:8080

  step29:
    title: ğŸš€ Running the images on another host with podman compose
    prompt: |
      Los pasos anteriores se pueden realizar mediante un archivo llamado podman-compose.yaml
      Use el archivo podman-compose.yaml proporcionado como ejemplo
      Acceda a una terminal y navegue a la carpeta {{ playbook_dir }}
      Ejecute el comando:

      podman-compose up

  step30:
    title: "ğŸ”š Fin del viaje con contenedores ğŸ‰"
    prompt: |
      Â¡Felicidades! Has completado el viaje con contenedores.
      Has aprendido los fundamentos de los contenedores y cÃ³mo ejecutar aplicaciones en contenedores.

      Si deseas aprender mÃ¡s sobre contenedores, visita:
      https://podman.io/
      https://developers.redhat.com/topics/containers